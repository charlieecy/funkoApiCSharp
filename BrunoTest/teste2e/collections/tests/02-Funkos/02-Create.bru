meta {
  name: 02-Create
  type: http
  seq: 2
}

post {
  url: {{baseUrl}}/Funkos
  body: multipartForm
  auth: bearer
}

auth:bearer {
  token: {{jwtToken}}
}

body:multipart-form {
  Nombre: FunkoTest_{{timestamp}}
  Categoria: MARVEL
  Precio: 19.99
  file: @file(placeholder.png)
}

script:pre-request {
  const timestamp = new Date().getTime();
  bru.setVar("timestamp", timestamp);
}

script:post-response {
  if (res.status === 201) {
    const body = res.getBody();
    if (body && body.id) {
      bru.setEnvVar("funkoId", body.id);
    }
  }
}

assert {
  res.status: eq 201
  res.body.id: isNumber
  res.body.nombre: contains FunkoTest
}
